axes = F)
m_cent <- apply(template,
2,
tapply,
INDEX = as.factor(DF[, i+2]),
mean)[,2:3]
points(m_cent,
cex = 4,
pch = 21,
bg = rownames(m_cent))
cor_mat <- as.matrix(rPLS_all[[i]])
if (length(cor_mat) == 1) {
colnames(cor_mat) <- rownames(m_cent)[1]
rownames(cor_mat) <- rownames(m_cent)[2]
}
for (j in rownames(cor_mat)) {
for (k in colnames(cor_mat)) {
m_line <- rbind(m_cent[j,],
m_cent[k,])
lines(m_line,
lwd = cor_mat[j,k] * 10,
col = alpha("black", 0.4))
text(apply(m_line, 2, mean)[1],
apply(m_line, 2, mean)[2],
labels = round(cor_mat[j,k], 2))
}
}
}
layout(matrix(c(1:6),
ncol = 2,
byrow = T))
par(mar = c(1, 2, 4, 1))
for (i in 1:6) {
plot(x = template[,2],
y = template[,3],
asp = 1,
pch = 21,
cex = 2,
bg = DF[, i+2],
main = "Head-Mandibles",
axes = F)
m_cent <- apply(template,
2,
tapply,
INDEX = as.factor(DF[, i+2]),
mean)[,2:3]
points(m_cent,
cex = 4,
pch = 21,
bg = rownames(m_cent))
cor_mat <- as.matrix(rPLS_all[[i]])
if (length(cor_mat) == 1) {
colnames(cor_mat) <- rownames(m_cent)[1]
rownames(cor_mat) <- rownames(m_cent)[2]
}
for (j in rownames(cor_mat)) {
for (k in colnames(cor_mat)) {
m_line <- rbind(m_cent[j,],
m_cent[k,])
lines(m_line,
lwd = cor_mat[j,k] * 10,
col = alpha("gray", 0.4))
text(apply(m_line, 2, mean)[1],
apply(m_line, 2, mean)[2],
labels = round(cor_mat[j,k], 2))
}
}
}
layout(matrix(c(1:6),
ncol = 2,
byrow = T))
par(mar = c(1, 2, 4, 1))
for (i in 1:6) {
plot(x = template[,2],
y = template[,3],
asp = 1,
pch = 21,
cex = 2,
bg = DF[, i+2],
main = "Head-Mandibles",
axes = F)
m_cent <- apply(template,
2,
tapply,
INDEX = as.factor(DF[, i+2]),
mean)[,2:3]
points(m_cent,
cex = 4,
pch = 21,
bg = rownames(m_cent))
cor_mat <- as.matrix(rPLS_all[[i]])
if (length(cor_mat) == 1) {
colnames(cor_mat) <- rownames(m_cent)[1]
rownames(cor_mat) <- rownames(m_cent)[2]
}
for (j in rownames(cor_mat)) {
for (k in colnames(cor_mat)) {
m_line <- rbind(m_cent[j,],
m_cent[k,])
lines(m_line,
lwd = cor_mat[j,k] * 10,
col = alpha("gray", 0.4))
text(apply(m_line, 2, mean)[1],
apply(m_line, 2, mean)[2],
labels = round(cor_mat[j,k], 2),
cex = 2)
}
}
}
m_cent
rownames(cor_mat)
cor_mat
rPLS_all[[i]]
cor_mat
rPLS_all[[2]]
as.matrix(rPLS_all[[2]])
rPLS_all[[2]]["2",]
rPLS_all[[2]][2,]
dist(rPLS_all[[2]])
layout(matrix(c(1:6),
ncol = 2,
byrow = T))
par(mar = c(1, 2, 4, 1))
for (i in 1:6) {
plot(x = template[,2],
y = template[,3],
asp = 1,
pch = 21,
cex = 2,
bg = DF[, i+2],
main = "Head-Mandibles",
axes = F)
m_cent <- apply(template,
2,
tapply,
INDEX = as.factor(DF[, i+2]),
mean)[,2:3]
cor_mat <- as.matrix(rPLS_all[[i]])
if (length(cor_mat) == 1) {
colnames(cor_mat) <- rownames(m_cent)[1]
rownames(cor_mat) <- rownames(m_cent)[2]
}
for (j in rownames(cor_mat)) {
for (k in colnames(cor_mat)) {
m_line <- rbind(m_cent[j,],
m_cent[k,])
lines(m_line,
lwd = cor_mat[j,k] * 10,
col = alpha("gray", 0.4))
text(apply(m_line, 2, mean)[1],
apply(m_line, 2, mean)[2],
labels = round(cor_mat[j,k], 2),
cex = 1.5)
}
points(m_cent,
cex = 4,
pch = 21,
bg = rownames(m_cent))
}
}
layout(matrix(c(1:6),
ncol = 2,
byrow = T))
par(mar = c(1, 2, 4, 1))
for (i in 1:6) {
plot(x = template[,2],
y = template[,3],
asp = 1,
pch = 21,
cex = 2,
bg = DF[, i+2],
main = colnames(DF)[i+2],
axes = F)
m_cent <- apply(template,
2,
tapply,
INDEX = as.factor(DF[, i+2]),
mean)[,2:3]
cor_mat <- as.matrix(rPLS_all[[i]])
if (length(cor_mat) == 1) {
colnames(cor_mat) <- rownames(m_cent)[1]
rownames(cor_mat) <- rownames(m_cent)[2]
}
for (j in rownames(cor_mat)) {
for (k in colnames(cor_mat)) {
m_line <- rbind(m_cent[j,],
m_cent[k,])
lines(m_line,
lwd = cor_mat[j,k] * 10,
col = alpha("gray", 0.4))
text(apply(m_line, 2, mean)[1],
apply(m_line, 2, mean)[2],
labels = round(cor_mat[j,k], 2),
cex = 1.5)
}
points(m_cent,
cex = 4,
pch = 21,
bg = rownames(m_cent))
}
}
cor_mat
t(cor_mat)
matrix(rep(c(0, cor_mat),
2),
ncol = 2)
matrix(rep(c(0, cor_mat),
each = 2),
ncol = 2)
matrix(rep(c(0, cor_mat), 2),
ncol = 2, byrow = T)
matrix(rep(c(0, cor_mat), 2),
ncol = 2, byrow = F)
matrix(rep(c(0, cor_mat),each = 2),
ncol = 2, byrow = F)
matrix(rep(c(0, cor_mat),each = 2),
ncol = 2, byrow = T)
rep(c(0, cor_mat), 2)
?rep
rep(c(0, cor_mat), times =2)
matrix(rep(c(0, cor_mat), 2),
ncol = 2, byrow = T)
matrix(rep(c(0, cor_mat), each = 2),
ncol = 2, byrow = T)
rep(c(0, cor_mat), each = 2)
matrix(c(0, cor_mat, cor_mat, 0),
ncol = 2, byrow = T)
m_cent
layout(matrix(c(1:6),
ncol = 2,
byrow = T))
par(mar = c(1, 2, 4, 1))
for (i in 1:6) {
plot(x = template[,2],
y = template[,3],
asp = 1,
pch = 21,
cex = 2,
bg = DF[, i+2],
main = colnames(DF)[i+2],
axes = F)
m_cent <- apply(template,
2,
tapply,
INDEX = as.factor(DF[, i+2]),
mean)[,2:3]
cor_mat <- as.matrix(rPLS_all[[i]])
if (length(cor_mat) == 1) {
cor_mat <- matrix(c(0, cor_mat, cor_mat, 0),
ncol = 2, byrow = T)
colnames(cor_mat) <- rownames(m_cent)
rownames(cor_mat) <- rownames(m_cent)
}
for (j in rownames(cor_mat)) {
for (k in colnames(cor_mat)) {
m_line <- rbind(m_cent[j,],
m_cent[k,])
lines(m_line,
lwd = cor_mat[j,k] * 10,
col = alpha("gray", 0.2))
text(apply(m_line, 2, mean)[1],
apply(m_line, 2, mean)[2],
labels = round(cor_mat[j,k], 2),
cex = 1.5)
}
points(m_cent,
cex = 4,
pch = 21,
bg = rownames(m_cent))
}
}
layout(matrix(c(1:6),
ncol = 2,
byrow = T))
par(mar = c(1, 2, 4, 1))
for (i in 1:6) {
plot(x = template[,2],
y = template[,3],
asp = 1,
pch = 21,
cex = 2,
bg = DF[, i+2],
main = colnames(DF)[i+2],
axes = F)
m_cent <- apply(template,
2,
tapply,
INDEX = as.factor(DF[, i+2]),
mean)[,2:3]
cor_mat <- as.matrix(rPLS_all[[i]])
if (length(cor_mat) == 1) {
cor_mat <- matrix(c(0, cor_mat, cor_mat, 0),
ncol = 2, byrow = T)
colnames(cor_mat) <- rownames(m_cent)
rownames(cor_mat) <- rownames(m_cent)
}
for (j in rownames(cor_mat)) {
for (k in colnames(cor_mat)) {
m_line <- rbind(m_cent[j,],
m_cent[k,])
lines(m_line,
lwd = cor_mat[j,k] * 10,
col = alpha("gray", 0.3))
text(apply(m_line, 2, mean)[1],
apply(m_line, 2, mean)[2],
labels = round(cor_mat[j,k], 2),
cex = 1.5)
}
points(m_cent,
cex = 4,
pch = 21,
bg = rownames(m_cent))
}
}
layout(matrix(c(1:6),
ncol = 2,
byrow = T))
par(mar = c(1, 2, 4, 1))
for (i in 1:6) {
plot(x = template[,2],
y = template[,3],
asp = 1,
pch = 21,
cex = 2,
bg = DF[, i+2],
main = colnames(DF)[i+2],
axes = F)
m_cent <- apply(template,
2,
tapply,
INDEX = as.factor(DF[, i+2]),
mean)[,2:3]
cor_mat <- as.matrix(rPLS_all[[i]])
if (length(cor_mat) == 1) {
cor_mat <- matrix(c(0, cor_mat, cor_mat, 0),
ncol = 2, byrow = T)
colnames(cor_mat) <- rownames(m_cent)
rownames(cor_mat) <- rownames(m_cent)
}
for (j in rownames(cor_mat)) {
for (k in colnames(cor_mat)) {
m_line <- rbind(m_cent[j,],
m_cent[k,])
lines(m_line,
lwd = cor_mat[j,k] * 20,
col = alpha("gray", 0.3))
text(apply(m_line, 2, mean)[1],
apply(m_line, 2, mean)[2],
labels = round(cor_mat[j,k], 2),
cex = 1.5)
}
points(m_cent,
cex = 4,
pch = 21,
bg = rownames(m_cent))
}
}
input_folder
pdf(file = paste(input_folder,
"pairwise_integration_PLS.pdf",
sep = ""),
height = 12,
width = 5)
layout(matrix(c(1:6),
ncol = 2,
byrow = T))
par(mar = c(1, 2, 4, 1))
for (i in 1:6) {
plot(x = template[,2],
y = template[,3],
asp = 1,
pch = 21,
cex = 2,
bg = DF[, i+2],
main = colnames(DF)[i+2],
axes = F)
m_cent <- apply(template,
2,
tapply,
INDEX = as.factor(DF[, i+2]),
mean)[,2:3]
cor_mat <- as.matrix(rPLS_all[[i]])
if (length(cor_mat) == 1) {
cor_mat <- matrix(c(0, cor_mat, cor_mat, 0),
ncol = 2, byrow = T)
colnames(cor_mat) <- rownames(m_cent)
rownames(cor_mat) <- rownames(m_cent)
}
for (j in rownames(cor_mat)) {
for (k in colnames(cor_mat)) {
m_line <- rbind(m_cent[j,],
m_cent[k,])
lines(m_line,
lwd = cor_mat[j,k] * 20,
col = alpha("gray", 0.3))
text(apply(m_line, 2, mean)[1],
apply(m_line, 2, mean)[2],
labels = round(cor_mat[j,k], 2),
cex = 1.5)
}
points(m_cent,
cex = 4,
pch = 21,
bg = rownames(m_cent))
}
}
dev.off()
pdf(file = paste(input_folder,
"pairwise_integration_PLS.pdf",
sep = ""),
height = 12,
width = 5)
layout(matrix(c(1:6),
ncol = 2,
byrow = T))
par(mar = c(1, 2, 4, 1))
for (i in 1:6) {
plot(x = template[,2],
y = template[,3],
asp = 1,
pch = 21,
cex = 1,
bg = DF[, i+2],
main = colnames(DF)[i+2],
axes = F)
m_cent <- apply(template,
2,
tapply,
INDEX = as.factor(DF[, i+2]),
mean)[,2:3]
cor_mat <- as.matrix(rPLS_all[[i]])
if (length(cor_mat) == 1) {
cor_mat <- matrix(c(0, cor_mat, cor_mat, 0),
ncol = 2, byrow = T)
colnames(cor_mat) <- rownames(m_cent)
rownames(cor_mat) <- rownames(m_cent)
}
for (j in rownames(cor_mat)) {
for (k in colnames(cor_mat)) {
m_line <- rbind(m_cent[j,],
m_cent[k,])
lines(m_line,
lwd = cor_mat[j,k] * 20,
col = alpha("gray", 0.3))
text(apply(m_line, 2, mean)[1],
apply(m_line, 2, mean)[2],
labels = round(cor_mat[j,k], 2),
cex = 1.5)
}
points(m_cent,
cex = 4,
pch = 21,
bg = rownames(m_cent))
}
}
dev.off()
pdf(file = paste(input_folder,
"pairwise_integration_PLS.pdf",
sep = ""),
height = 12,
width = 5)
layout(matrix(c(1:6),
ncol = 2,
byrow = T))
par(mar = c(1, 2, 4, 1))
for (i in 1:6) {
plot(x = template[,2],
y = template[,3],
asp = 1,
pch = 21,
cex = 1.5,
bg = DF[, i+2],
main = colnames(DF)[i+2],
axes = F)
m_cent <- apply(template,
2,
tapply,
INDEX = as.factor(DF[, i+2]),
mean)[,2:3]
cor_mat <- as.matrix(rPLS_all[[i]])
if (length(cor_mat) == 1) {
cor_mat <- matrix(c(0, cor_mat, cor_mat, 0),
ncol = 2, byrow = T)
colnames(cor_mat) <- rownames(m_cent)
rownames(cor_mat) <- rownames(m_cent)
}
for (j in rownames(cor_mat)) {
for (k in colnames(cor_mat)) {
m_line <- rbind(m_cent[j,],
m_cent[k,])
lines(m_line,
lwd = cor_mat[j,k] * 20,
col = alpha("gray", 0.3))
text(apply(m_line, 2, mean)[1],
apply(m_line, 2, mean)[2],
labels = round(cor_mat[j,k], 2),
cex = 1.5)
}
points(m_cent,
cex = 4,
pch = 21,
bg = rownames(m_cent))
}
}
dev.off
dev.off()
dat
dim(A)
TA
BF
bf2
dat
