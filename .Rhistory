land_pairs[[1]] <- c(3, 12)
land_pairs[[2]] <- c(4, 11)
plot(shapes[,2,], shapes[,3,])
text(shapes[,2,1], shapes[,3,1], col=2, labels = 1:35, cex = 3)
t(c(DF[,1]))
c(DF[,1])
land_pairs <- list()
land_pairs[[1]] <- c(3, 12)
land_pairs[[2]] <- c(4, 11)
land_pairs[[3]] <- c(5, 9)
land_pairs[[4]] <- c(6, 8)
land_pairs[[5]] <- c(7, 10)
land_pairs[[6]] <- c(3, 12)
land_pairs[[7]] <- c(14, 15)
land_pairs[[8]] <- c(16, 17)
land_pairs[[9]] <- c(18, 21)
land_pairs[[10]] <- c(19, 22)
land_pairs[[11]] <- c(20, 23)
land_pairs[[12]] <- c(24, 25)
land_pairs[[13]] <- c(26, 30)
land_pairs[[14]] <- c(27, 31)
land_pairs[[15]] <- c(28, 32)
land_pairs[[16]] <- c(29, 33)
land_pairs[[17]] <- c(34, 35)
land_pairs
bilat_sym <- bilat.symmetry(A = shapes,
ind = ID,
replicate = replic,
object.sym = T,
land.pairs = land_pairs)
unlist(land_pairs)
as.matrix(unlist(land_pairs), ncol = 2, byrow = T)
matrix(unlist(land_pairs), ncol = 2, byrow = T)
land_pairs <- matrix(unlist(land_pairs),
ncol = 2,
byrow = T)
bilat_sym <- bilat.symmetry(A = shapes,
ind = ID,
replicate = replic,
object.sym = T,
land.pairs = land_pairs)
bilat_sym
bilat_sym <- bilat.symmetry(A = shapes,
ind = ID,
replicate = replic,
object.sym = T,
land.pairs = land_pairs,SS.type = "II")
bilat_sym
summary(manova(lm(prcomp(decomp_asym$matshp)$x[,1:50] ~
decomp_asym$indiv.fac.mirror * decomp_asym$mirror.fac)))
summary(manova(lm(prcomp(decomp_asym$matshp)$x[,1] ~
decomp_asym$indiv.fac.mirror * decomp_asym$mirror.fac)))
summary(manova(lm(prcomp(decomp_asym$matshp)$x[,1:2] ~
decomp_asym$indiv.fac.mirror * decomp_asym$mirror.fac)))
?bilat.symmetry
bilat_sym <- bilat.symmetry(A = shapes,
ind = ID,
replicate = replic,
object.sym = T,
land.pairs = land_pairs)
bilat_sym$signed.AI
TQ
TA
cor.test(bilat_sym$signed.AI, TA)
bilat_sym$DA.component
plot(bilat_sym$DA.component[,,1])
plot(bilat_sym$DA.component[,2:3,1], asp=1, pch = 20)
plot(bilat_sym$DA.component[,c(1,3),1], asp=1, pch = 20)
plot(bilat_sym$DA.component[,c(1,2),1], asp=1, pch = 20)
plot(bilat_sym$DA.component[,c(2,1),1], asp=1, pch = 20)
points(bilat_sym$DA.component[,c(2,1),2], asp=1, pch = 20, col = 2)
bilat_sym$FA.component
cor.test(bilat_sym$signed.AI, bf)
cor.test(bilat_sym$signed.AI, bf2)
cor.test(bilat_sym$signed.AI, mbf2)
cor.test(bilat_sym$signed.AI, mbf)
plot(bilat_sym$signed.AI, bf)
plot(bilat_sym$signed.AI, bf2)
modul_compar
?cat
integ_test_1
?integration.test
bilat_sym
?bilat.symmetry
integ_test_4
?modularity.test
DF[,3]
DF[,5]
newpart <- DF[,5]
newpart[which(newpart == 1)] <- NA
newpart
integ_test_5 <- integration.test(A = A,
partition.gp = newpart,
iter = 999)
integ_test_5
integ_compar <- compare.pls(integ_test_1,
integ_test_2,
integ_test_3,
integ_test_4,
integ_test_5)
integ_compar
?two.b.pls
A <- av_A #No need for replicates
integ_test_5 <- integration.test(A = A,
partition.gp = newpart,
iter = 999)
integ_test_5
integ_test_5 <- integration.test(A = A,
partition.gp = newpart,
iter = 999)
integ_test_5
which(DF[,5] == 2 | DF[,5] == 3)
A1 <- A[which(DF[,5] == 2),,]
A2 <- A[which(DF[,5] == 3),,]
tbpls <- two.b.pls(A1 = A1,
A2 = A2)
tbpls
TA
DA
var(DA)
var(bf2)
bf2
var(bf2, na.rm = T)
sd(bf2, na.rm = T)/mean(bf2, na.rm = T)
sd(DA, na.rm = T)/mean(DA, na.rm = T)
modul_compar <- compare.CR(modul_test_1,
modul_test_2,
modul_test_3,
modul_test_4)
modul_compar
integ_test_1
TA
DA
cor.test(TA, DA)
sd(DA)/mean(DA)
sd(DA)/mean(abs(DA))
sd(BF)/mean(abs(BF))
bf
bf2
cor.test(DA,bf)
cor.test(DA,bf2)
sd(bf, na.rm = T)/mean(bf, na.rm = T)
csiz
sd(csiz, na.rm = T)/mean(csiz, na.rm = T)
sd(HL, na.rm = T)/mean(HL, na.rm = T)
sd(head_l, na.rm = T)/mean(head_l, na.rm = T)
sd(TA, na.rm = T)/mean(TA, na.rm = T)
CVTA <- sd(TA, na.rm = T)/mean(TA, na.rm = T)
CVDA <- sd(DA, na.rm = T)/mean(abs(DA), na.rm = T)
CVBF <- sd(bf, na.rm = T)/mean(bf, na.rm = T)
CVBF2 <- sd(bf2, na.rm = T)/mean(bf2, na.rm = T)
CVHL <- sd(head_l, na.rm = T)/mean(head_l, na.rm = T)
CVsiz <- sd(csiz, na.rm = T)/mean(csiz, na.rm = T)
CVTA
hist(TA)
hist(TA, xlim = c(0,0.2))
shapiro.test(TA)
shapiro.test(DA)
bilat_sym
0.02410/0.59138
0.05559/0.59138
0.14689/0.59138
0.36480/0.59138
mat1 <- matrix(c(0,2,3,1,0,2,2,0.5,0), ncol =3)
mat1
mat2 <- matrix(c(0,1,2,1,0,0.5,2,0.5,0), ncol =3)
mat2
mat1*mat1
mat1%*%mat1
help("%*%")
# Required packages:
library(geomorph)
library(EMMLi)
library(abind)
library(scales)
source("../repo/001_functions.R")
source("../repo/002_asym_components.R")
source("Rfunctions1.txt")
#-------------------------------------------------------------------------------
# Load landÃ¶ark template
LM_template <- read.csv("data/LM_template.csv")
names_LM <- LM_template[,1]
no_modularity <- rep(1,
length(names_LM))
head_mand <- c(1, 1, 2, 1, 1, 1, 1, 1, 1, 1,
1, 1, 1, 1, 2, 1, 1, 1, 2, 2,
2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
2, 2, 2, 2, 2, 2, 1, 1)
names_LM
head_mand_sens <- c(1, 1, 2, 1, 3, 3, 3, 1, 1, 1,
3, 3, 3, 1, 2, 3, 1, 1, 2, 2,
2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
2, 2, 2, 2, 2, 2, 3, 3)
head_mand_asym <- c(1, 1, 2, 1, 1, 1, 1, 1, 1, 1,
1, 1, 1, 1, 3, 1, 1, 1, 2, 3,
2, 2, 2, 3, 3, 3, 2, 3, 2, 2,
2, 2, 3, 3, 3, 3, 1, 1)
head_mand_asym_sens <- c(1, 1, 2, 1, 4, 4, 4, 1, 1, 1,
4, 4, 4, 1, 3, 4, 1, 1, 2, 3,
2, 2, 2, 3, 3, 3, 2, 3, 2, 2,
2, 2, 3, 3, 3, 3, 4, 4)
df_modul_models <- data.frame(name = names_LM,
no_modul = no_modularity,
head_mand = head_mand,
head_mand_sens = head_mand_sens,
head_mand_asym = head_mand_asym,
head_mand_asym_sens = head_mand_asym_sens)
layout(matrix(c(1:4),
ncol = 2,
byrow = T))
par(mar = c(1, 2, 4, 1))
plot(shapes[,2:3,1],
asp = 1,
pch = 20,
cex = 2,
col = head_mand[-c(8:10)],
main = "Head-Mandibles",
axes = F)
plot(shapes[,2:3,1],
asp = 1,
pch = 20,
cex = 2,
col = head_mand_asym[-c(8:10)],
main = "Head-Mandibles-Asymmetric",
axes = F)
plot(shapes[,2:3,1],
asp = 1,
pch = 20,
cex = 2,
col = head_mand_sens[-c(8:10)],
main = "Head-Mandibles-Sensory",
axes = F)
plot(shapes[,2:3,1],
asp = 1,
pch = 20,
cex = 2,
col = head_mand_asym_sens[-c(8:10)],
main = "Head-Mandibles-Asym-Sensory",
axes = F)
layout(matrix(c(1:4),
ncol = 2,
byrow = T))
par(mar = c(1, 2, 4, 1))
plot(shapes[,2:3,1],
asp = 1,
pch = 21,
cex = 2,
bg = head_mand[-c(8:10)],
main = "Head-Mandibles",
axes = F)
plot(shapes[,2:3,1],
asp = 1,
pch = 20,
cex = 2,
col = head_mand_asym[-c(8:10)],
main = "Head-Mandibles-Asymmetric",
axes = F)
layout(matrix(c(1:4),
ncol = 2,
byrow = T))
par(mar = c(1, 2, 4, 1))
plot(shapes[,2:3,1],
asp = 1,
pch = 21,
cex = 2,
bg = head_mand[-c(8:10)],
main = "Head-Mandibles",
axes = F)
plot(shapes[,2:3,1],
asp = 1,
pch = 21,
cex = 2,
bg = head_mand_asym[-c(8:10)],
main = "Head-Mandibles-Asymmetric",
axes = F)
plot(shapes[,2:3,1],
asp = 1,
pch = 21,
cex = 2,
bg = head_mand_sens[-c(8:10)],
main = "Head-Mandibles-Sensory",
axes = F)
plot(shapes[,2:3,1],
asp = 1,
pch = 21,
cex = 2,
bg = head_mand_asym_sens[-c(8:10)],
main = "Head-Mandibles-Asym-Sensory",
axes = F)
layout(matrix(c(1:4),
ncol = 2,
byrow = T))
par(mar = c(1, 2, 4, 1))
plot(shapes[,2:3,1],
asp = 1,
pch = 21,
cex = 2,
bg = head_mand[-c(8:10)]+2,
main = "Head-Mandibles",
axes = F)
plot(shapes[,2:3,1],
asp = 1,
pch = 21,
cex = 2,
bg = head_mand_asym[-c(8:10)]+2,
main = "Head-Mandibles-Asymmetric",
axes = F)
plot(shapes[,2:3,1],
asp = 1,
pch = 21,
cex = 2,
bg = head_mand_sens[-c(8:10)]+2,
main = "Head-Mandibles-Sensory",
axes = F)
plot(shapes[,2:3,1],
asp = 1,
pch = 21,
cex = 2,
bg = head_mand_asym_sens[-c(8:10)]+2,
main = "Head-Mandibles-Asym-Sensory",
axes = F)
version()
version
palette.colors(palette = "Okabe-Ito")
palette <- palette.colors(palette = "Okabe-Ito")
palette() <- palette.colors(palette = "Okabe-Ito")
palette
palette()
palette(palette.colors(palette = "Okabe-Ito"))
palette
palette()
layout(matrix(c(1:4),
ncol = 2,
byrow = T))
par(mar = c(1, 2, 4, 1))
plot(shapes[,2:3,1],
asp = 1,
pch = 21,
cex = 2,
bg = head_mand[-c(8:10)],
main = "Head-Mandibles",
axes = F)
plot(shapes[,2:3,1],
asp = 1,
pch = 21,
cex = 2,
bg = head_mand_asym[-c(8:10)],
main = "Head-Mandibles-Asymmetric",
axes = F)
plot(shapes[,2:3,1],
asp = 1,
pch = 21,
cex = 2,
bg = head_mand_sens[-c(8:10)],
main = "Head-Mandibles-Sensory",
axes = F)
plot(shapes[,2:3,1],
asp = 1,
pch = 21,
cex = 2,
bg = head_mand_asym_sens[-c(8:10)],
main = "Head-Mandibles-Asym-Sensory",
axes = F)
input_folder <- "Figures/"
input_folder <- "Figures/"
pdf(file = paste(input_folder, "Module_Models.pdf"),
width = 5,
height = 9)
layout(matrix(c(1:4),
ncol = 2,
byrow = T))
par(mar = c(1, 2, 4, 1))
plot(shapes[,2:3,1],
asp = 1,
pch = 21,
cex = 2,
bg = head_mand[-c(8:10)],
main = "Head-Mandibles",
axes = F)
plot(shapes[,2:3,1],
asp = 1,
pch = 21,
cex = 2,
bg = head_mand_asym[-c(8:10)],
main = "Head-Mandibles-Asymmetric",
axes = F)
plot(shapes[,2:3,1],
asp = 1,
pch = 21,
cex = 2,
bg = head_mand_sens[-c(8:10)],
main = "Head-Mandibles-Sensory",
axes = F)
plot(shapes[,2:3,1],
asp = 1,
pch = 21,
cex = 2,
bg = head_mand_asym_sens[-c(8:10)],
main = "Head-Mandibles-Asym-Sensory",
axes = F)
dev.off()
input_folder <- "Figures/"
pdf(file = paste(input_folder, "Module_Models.pdf"),
width = 5,
height = 10)
layout(matrix(c(1:4),
ncol = 2,
byrow = T))
par(mar = c(1, 2, 4, 1))
plot(shapes[,2:3,1],
asp = 1,
pch = 21,
cex = 2,
bg = head_mand[-c(8:10)],
main = "Head-Mandibles",
axes = F)
plot(shapes[,2:3,1],
asp = 1,
pch = 21,
cex = 2,
bg = head_mand_asym[-c(8:10)],
main = "Head-Mandibles-Asymmetric",
axes = F)
plot(shapes[,2:3,1],
asp = 1,
pch = 21,
cex = 2,
bg = head_mand_sens[-c(8:10)],
main = "Head-Mandibles-Sensory",
axes = F)
plot(shapes[,2:3,1],
asp = 1,
pch = 21,
cex = 2,
bg = head_mand_asym_sens[-c(8:10)],
main = "Head-Mandibles-Asym-Sensory",
axes = F)
dev.off()
input_folder <- "Figures/"
pdf(file = paste(input_folder, "Module_Models.pdf"),
width = 5,
height = 12)
layout(matrix(c(1:4),
ncol = 2,
byrow = T))
par(mar = c(1, 2, 4, 1))
plot(shapes[,2:3,1],
asp = 1,
pch = 21,
cex = 2,
bg = head_mand[-c(8:10)],
main = "Head-Mandibles",
axes = F)
plot(shapes[,2:3,1],
asp = 1,
pch = 21,
cex = 2,
bg = head_mand_asym[-c(8:10)],
main = "Head-Mandibles-Asymmetric",
axes = F)
plot(shapes[,2:3,1],
asp = 1,
pch = 21,
cex = 2,
bg = head_mand_sens[-c(8:10)],
main = "Head-Mandibles-Sensory",
axes = F)
plot(shapes[,2:3,1],
asp = 1,
pch = 21,
cex = 2,
bg = head_mand_asym_sens[-c(8:10)],
main = "Head-Mandibles-Asym-Sensory",
axes = F)
dev.off()
input_folder <- "Figures/"
pdf(file = paste(input_folder, "Module_Models.pdf"),
width = 6,
height = 9)
layout(matrix(c(1:4),
ncol = 2,
byrow = T))
par(mar = c(1, 2, 4, 1))
plot(shapes[,2:3,1],
asp = 1,
pch = 21,
cex = 2,
bg = head_mand[-c(8:10)],
main = "Head-Mandibles",
axes = F)
plot(shapes[,2:3,1],
asp = 1,
pch = 21,
cex = 2,
bg = head_mand_asym[-c(8:10)],
main = "Head-Mandibles-Asymmetric",
axes = F)
plot(shapes[,2:3,1],
asp = 1,
pch = 21,
cex = 2,
bg = head_mand_sens[-c(8:10)],
main = "Head-Mandibles-Sensory",
axes = F)
plot(shapes[,2:3,1],
asp = 1,
pch = 21,
cex = 2,
bg = head_mand_asym_sens[-c(8:10)],
main = "Head-Mandibles-Asym-Sensory",
axes = F)
dev.off()
